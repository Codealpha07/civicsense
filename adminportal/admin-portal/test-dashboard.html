<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>Dashboard Diagnostic Page</h1>
    <div id="status"></div>
    <div id="tab-content"></div>

    <script>
        // Diagnostic logging function
        function log(message, type = 'info') {
            console.log(message);
            const statusEl = document.getElementById('status');
            const messageEl = document.createElement('div');
            messageEl.textContent = message;
            messageEl.className = type;
            statusEl.appendChild(messageEl);
        }

        // Mock API Implementation
        window.mockApi = {
            getComplaints: function() {
                log('getComplaints method called', 'success');
                return Promise.resolve({
                    data: [
                        { id: 'C1', title: 'Pothole', status: 'pending' },
                        { id: 'C2', title: 'Streetlight', status: 'in-progress' }
                    ],
                    message: 'Complaints retrieved successfully'
                });
            }
        };

        // Dashboard Script
        document.addEventListener('DOMContentLoaded', function() {
            log('DOM Content Loaded');
            
            // Verify mockApi
            log('Window mockApi: ' + (window.mockApi ? 'FOUND' : 'NOT FOUND'), 
                window.mockApi ? 'success' : 'error');
            
            if (window.mockApi && window.mockApi.getComplaints) {
                log('Calling getComplaints', 'success');
                
                window.mockApi.getComplaints()
                    .then(function(result) {
                        log('Complaints retrieved successfully', 'success');
                        
                        const tabContent = document.getElementById('tab-content');
                        if (tabContent) {
                            tabContent.innerHTML = result.data.map(function(complaint) {
                                return '<div class="complaint">' +
                                       '<h3>' + complaint.title + '</h3>' +
                                       '<p>Status: ' + complaint.status + '</p>' +
                                       '</div>';
                            }).join('');
                        }
                    })
                    .catch(function(error) {
                        log('Error retrieving complaints: ' + error, 'error');
                    });
            } else {
                log('MockAPI or getComplaints method not found', 'error');
            }
        });
    </script>
</body>
</html> 